'use strict';(function(){function a(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}function b(a){a.animation?requestAnimFrame(c):drawPieSegments(1)}function c(){animCount+=animFrameAmount,drawPieSegments(easingFunction(animCount)),1>animCount?requestAnimFrame(arguments.callee):settings.afterDrawed.call(this)}function d(a){return Math.min.apply(null,a)}var e=function(a){var b=document.createElement('div');return b.innerHTML=a,b.childNodes[0]};window.drawPieChart=function(c,f){function h(a){var b=this.dataset.order;J.textContent=c[b].title+': '+c[b].value,J.style.opacity=1,'active'!==A[b].getAttribute('data-active')&&(C[b].style.opacity=.8),w.onPieMouseenter.apply(this,[a,c])}function j(a){var b=this.dataset.order;J.style.opacity=0,'active'!==A[b].getAttribute('data-active')&&(C[b].style.opacity=w.lightPiesOpacity),w.onPieMouseleave.apply(this,[a,c])}function k(a){J.style.top=a.pageY+w.tipOffsetY+'px',J.style.left=a.pageX-J.clientWidth/2+w.tipOffsetX+'px'}function l(a){for(var b=this.dataset.order,d=A[b],e=0,f=c.length;e<f;e++)e!==b&&(A[e].setAttribute('data-active',''),C[e].style.opacity=w.lightPiesOpacity);'active'===d.getAttribute('data-active')?(d.setAttribute('data-active',''),C[b].style.opacity=.8):(d.setAttribute('data-active','active'),C[b].style.opacity=1),w.onPieClick.apply(this,[a,c])}var m,n=this.clientWidth,o=this.clientHeight,q=0;f.legend&&(m=document.createElementNS('http://www.w3.org/2000/svg','g'),m.classList.add('legend'),c.forEach(function(a){var b=document.createElementNS('http://www.w3.org/2000/svg','g'),c=document.createElementNS('http://www.w3.org/2000/svg','rect');c.setAttribute('width','10'),c.setAttribute('height','10'),b.setAttribute('transform','translate(0,'+(150+(q+=20))+')');var d=document.createElementNS('http://www.w3.org/2000/svg','text');d.innerHTML=a.title,d.setAttribute('y',11),d.setAttribute('x',20),c.setAttribute('fill',a.color),b.appendChild(c),b.appendChild(d),m.appendChild(b)}),o-=q);var r=n/2,s=o/2,t=Math.cos,u=Math.sin,v=Math.PI,w=a({segmentShowStroke:!0,segmentStrokeColor:'#fff',segmentStrokeWidth:1,baseColor:'#fff',baseOffset:15,edgeOffset:30,pieSegmentGroupClass:'pieSegmentGroup',pieSegmentClass:'pieSegment',lightPiesOffset:12,lightPiesOpacity:.3,lightPieClass:'lightPie',animation:!0,animationSteps:90,animationEasing:'easeInOutExpo',tipOffsetX:0,tipOffsetY:-50,tipClass:'pieTip',beforeDraw:function a(){},afterDrawed:function a(){},onPieMouseenter:function a(){},onPieMouseleave:function a(){},onPieClick:function a(){},legend:!1},f),x=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),z=e('<svg width="'+n+'" height="'+(o+q)+'" viewBox="0 0 '+n+' '+(o+q)+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>');this.appendChild(z);var A=[],B=[],C=[],D={linear:function b(a){return a},easeInOutExpo:function c(a){var b=.5>a?8*a*a*a*a:1-8*--a*a*a*a;return 1<b?1:b}}[w.animationEasing],E=d([o/2,n/2])-w.edgeOffset,F=0,G=function(){var a=document.createElementNS('http://www.w3.org/2000/svg','circle');z.appendChild(a),a.classList.add('pie'),a.setAttribute('cx',r),a.setAttribute('cy',s),a.setAttribute('r',E+w.baseOffset),a.setAttribute('fill',w.baseColor)}();f.legend&&m.setAttribute('transform','translate(0,'+E+')');var I=document.createElementNS('http://www.w3.org/2000/svg','g');I.setAttribute('opacity',0),z.appendChild(I);var J=document.createElement('div');w.tipClass&&J.classList.add(w.tipClass),J.style.transition='opacity 0.2s',document.body.appendChild(J),J.style.opacity=0;for(var K=J.clientWidth,L=J.clientHeight,M=0,N=c.length;M<N;M++){F+=c[M].value;var Q=document.createElementNS('http://www.w3.org/2000/svg','g');'undefined'==typeof Q.dataset&&(Q.dataset={}),Q.dataset.order=M,Q.setAttribute('class',w.pieSegmentGroupClass),A[M]=Q,I.appendChild(Q),A[M].addEventListener('mouseenter',h),A[M].addEventListener('mouseleave',j),A[M].addEventListener('mousemove',k),A[M].addEventListener('click',l);var g=document.createElementNS('http://www.w3.org/2000/svg','path');g.setAttribute('stroke-width',w.segmentStrokeWidth),g.setAttribute('stroke',w.segmentStrokeColor),g.setAttribute('stroke-miterlimit',2),g.setAttribute('fill',c[M].color),g.setAttribute('class',w.pieSegmentClass),B[M]=g,A[M].appendChild(g),f.legend&&z.appendChild(m);var p=document.createElementNS('http://www.w3.org/2000/svg','path');p.setAttribute('stroke-width',w.segmentStrokeWidth),p.setAttribute('stroke',w.segmentStrokeColor),p.setAttribute('stroke-miterlimit',2),p.setAttribute('fill',c[M].color),p.setAttribute('opacity',w.lightPiesOpacity),p.setAttribute('class',w.lightPieClass),p.style.transition='opacity .1s',C[M]=p,A[M].appendChild(p)}w.beforeDraw.call(this),b(w);var O=w.animation?1/w.animationSteps:1,P=w.animation?0:1;return this}})();