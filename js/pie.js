(function(){function a(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}function b(a){var b=document.createElement('div');return b.innerHTML=a,b.childNodes[0]}window.drawPieChart=function(c,d){function e(a){var b=this.dataset.order;J.textContent=c[b].title+': '+c[b].value,J.style.opacity=1,'active'!==A[b].getAttribute('data-active')&&(C[b].style.opacity=.8),w.onPieMouseenter.apply(this,[a,c])}function f(a){var b=this.dataset.order;J.style.opacity=0,'active'!==A[b].getAttribute('data-active')&&(C[b].style.opacity=w.lightPiesOpacity),w.onPieMouseleave.apply(this,[a,c])}function h(a){J.style.top=a.pageY+w.tipOffsetY+'px',J.style.left=a.pageX-J.clientWidth/2+w.tipOffsetX+'px'}function j(a){for(var b=this.dataset.order,d=A[b],e=0,f=c.length;e<f;e++)e!==b&&(A[e].setAttribute('data-active',''),C[e].style.opacity=w.lightPiesOpacity);'active'===d.getAttribute('data-active')?(d.setAttribute('data-active',''),C[b].style.opacity=.8):(d.setAttribute('data-active','active'),C[b].style.opacity=1),w.onPieClick.apply(this,[a,c])}function k(a){var b=-v/2,d=1;w.animation&&(d=a),I.setAttribute('opacity',a);for(var e=0,f=c.length;e<f;e++){var g=d*(c[e].value/F*(2*v)),h=b+g,j=(h-b)%(2*v)>v?1:0,k=r+t(b)*E,l=s+u(b)*E,m=r+t(h)*E,n=s+u(h)*E,o=r+t(b)*(E+w.lightPiesOffset),p=s+u(b)*(E+w.lightPiesOffset),q=r+t(h)*(E+w.lightPiesOffset),x=s+u(h)*(E+w.lightPiesOffset),y=['M',o,p,'A',E+w.lightPiesOffset,E+w.lightPiesOffset,0,j,1,q,x,'L',r,s,'Z'];B[e].setAttribute('d',['M',k,l,'A',E,E,0,j,1,m,n,'L',r,s,'Z'].join(' ')),C[e].setAttribute('d',y.join(' ')),b+=g}}function l(){Q+=P,k(D(Q)),1>Q?x(arguments.callee):w.afterDrawed.call(this)}var m=this.clientWidth,n=this.clientHeight,o=0;if(d.legend){var q=document.createElementNS('http://www.w3.org/2000/svg','g');q.classList.add('legend'),c.forEach(function(a){var b=document.createElementNS('http://www.w3.org/2000/svg','g'),c=document.createElementNS('http://www.w3.org/2000/svg','rect');c.setAttribute('width','10'),c.setAttribute('height','10'),b.setAttribute('transform','translate(0,'+(150+(o+=20))+')');var d=document.createElementNS('http://www.w3.org/2000/svg','text');d.innerHTML=a.title,d.setAttribute('y',11),d.setAttribute('x',20),c.setAttribute('fill',a.color),b.appendChild(c),b.appendChild(d),q.appendChild(b)}),n-=o}var r=m/2,s=n/2,t=Math.cos,u=Math.sin,v=Math.PI,w=a({segmentShowStroke:!0,segmentStrokeColor:'#fff',segmentStrokeWidth:1,baseColor:'#fff',baseOffset:15,edgeOffset:30,pieSegmentGroupClass:'pieSegmentGroup',pieSegmentClass:'pieSegment',lightPiesOffset:12,lightPiesOpacity:.3,lightPieClass:'lightPie',animation:!0,animationSteps:90,animationEasing:'easeInOutExpo',tipOffsetX:0,tipOffsetY:-50,tipClass:'pieTip',beforeDraw:function(){},afterDrawed:function(){},onPieMouseenter:function(){},onPieMouseleave:function(){},onPieClick:function(){},legend:!1},d),x=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),z=b('<svg width="'+m+'" height="'+(n+o)+'" viewBox="0 0 '+m+' '+(n+o)+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>');this.appendChild(z);var A=[],B=[],C=[],D={linear:function(a){return a},easeInOutExpo:function(a){var b=.5>a?8*a*a*a*a:1-8*--a*a*a*a;return 1<b?1:b}}[w.animationEasing],E=function(a){return Math.min.apply(null,a)}([n/2,m/2])-w.edgeOffset,F=0,G=function(){var a=document.createElementNS('http://www.w3.org/2000/svg','circle');z.appendChild(a),a.classList.add('pie'),a.setAttribute('cx',r),a.setAttribute('cy',s),a.setAttribute('r',E+w.baseOffset),a.setAttribute('fill',w.baseColor)}();d.legend&&q.setAttribute('transform','translate(0,'+E+')');var I=document.createElementNS('http://www.w3.org/2000/svg','g');I.setAttribute('opacity',0),z.appendChild(I);var J=document.createElement('div');w.tipClass&&J.classList.add(w.tipClass),J.style.transition='opacity 0.2s',document.body.appendChild(J),J.style.opacity=0;for(var K=J.clientWidth,L=J.clientHeight,M=0,N=c.length;M<N;M++){F+=c[M].value;var O=document.createElementNS('http://www.w3.org/2000/svg','g');'undefined'==typeof O.dataset&&(O.dataset={}),O.dataset.order=M,O.setAttribute('class',w.pieSegmentGroupClass),A[M]=O,I.appendChild(O),A[M].addEventListener('mouseenter',e),A[M].addEventListener('mouseleave',f),A[M].addEventListener('mousemove',h),A[M].addEventListener('click',j);var g=document.createElementNS('http://www.w3.org/2000/svg','path');g.setAttribute('stroke-width',w.segmentStrokeWidth),g.setAttribute('stroke',w.segmentStrokeColor),g.setAttribute('stroke-miterlimit',2),g.setAttribute('fill',c[M].color),g.setAttribute('class',w.pieSegmentClass),B[M]=g,A[M].appendChild(g),d.legend&&z.appendChild(q);var p=document.createElementNS('http://www.w3.org/2000/svg','path');p.setAttribute('stroke-width',w.segmentStrokeWidth),p.setAttribute('stroke',w.segmentStrokeColor),p.setAttribute('stroke-miterlimit',2),p.setAttribute('fill',c[M].color),p.setAttribute('opacity',w.lightPiesOpacity),p.setAttribute('class',w.lightPieClass),p.style.transition='opacity .1s',C[M]=p,A[M].appendChild(p)}w.beforeDraw.call(this),function(){w.animation?x(l):k(1)}();var P=w.animation?1/w.animationSteps:1,Q=w.animation?0:1;return this}})();